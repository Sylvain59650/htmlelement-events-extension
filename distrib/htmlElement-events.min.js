"use strict";

HTMLElement.prototype.on = function (evtName, fn, option) {
  var _this = this;

  var evts = evtName.split(" ");

  var _loop = function _loop(i) {
    var evt = evts[i];
    if (_this.addEventListener) {
      if (!!document.documentMode && option && option.once) {
        self = _this;

        fn.removed = false;

        _oneCall = function oneCall() {
          if (!fn.removed) {
            fn();
            fn.removed = true;
            self.off(evt, _oneCall);
          }
        };

        _this.addEventListener(evt, _oneCall, option || false);
      } else {
        _this.addEventListener(evt, fn, option || false);
      }
    } else if (_this.attachEvent) {
      _this.attachEvent("on" + evt, fn);
    }
  };

  for (var i = 0; i < evts.length; i++) {
    var self;

    var _oneCall;

    _loop(i);
  }
};

HTMLElement.prototype.off = function (evtNames, fn) {
  var evts = evtNames.split(" ");
  for (var i = 0; i < evts.length; i++) {
    var _evt = evts[i];
    if (this.removeEventListener) {
      this.removeEventListener(_evt, fn, false);
    } else if (this.detachEvent) {
      this.detachEvent("on" + _evt, fn);
    }
  }
};
window.on = window.addEventListener;
document.on = document.addEventListener;
window.off = window.removeEventListener;
document.off = document.removeEventListener;

// var _timersOne = [];
// var _timers = [];

// var _setUnload = false;

// function destroyTimers() {
//   alert("clear " + _timers.length + " " + _timersOne.length);
//   for (let i = 0; i < _timers.length; i++) {
//     clearTimeout(_timers[i]);
//   }
//   for (let i = 0; i < _timersOne.length; i++) {
//     clearTimeout(_timersOne[i]);
//   }
// }


// window.timerOne = function(fn, ms) {
//   if (!_setUnload) {
//     _setUnload = true;
//     window.addEventListener("unload", () => { destroyTimers(); });
//   }
//   _timersOne.push(window.setTimeout(fn, ms));
// }

// window.timer = function(fn, ms) {
//   if (!_setUnload) {
//     _setUnload = true;
//     window.addEventListener("unload", () => { destroyTimers(); });
//   }
//   _timers.push(window.setInterval(fn, ms));
// }